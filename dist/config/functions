# CUSTOM FUNCTIONS

tmuxxx () {
    # If no argument is passed, print the help message
    if [ -z "$1" ]; then
        echo "Usage: tmuxxx <session-name>";
        echo "Sessions: cer,homelab";
        return;
    fi

    # Check $1 is a valid session name
    if [ "$1" != "cer" ] && [ "$1" != "homelab" ]; then
        echo "Invalid session name";
        echo "Sessions: cer,homelab";
        return;
    fi

    # Start the tmux session
    tmux -f "$HOME/.tmux/tmux.conf" start-server \; source-file "$HOME/.tmux/$1"
    tmux attach-session -t $1
}


ramdisk () {
    ramdisk_path="$HOME/ramdisk"
    if [ ! -d "$ramdisk_path" ]; then
        echo "Creating RAM disk directory..."
        mkdir $ramdisk_path
    fi
    if [[ "$1" = "m" ]]; then
        echo "Mounting RAM disk..."
        sudo mount -t tmpfs -o size=2048M tmpfs $ramdisk_path
    elif [[ "$1" = "u" ]]; then
        echo "Unmounting RAM disk..."
        sudo umount $ramdisk_path
    else
        echo "Usage:"
        echo "ramdisk m -- mounts RAM disk"
        echo "ramdisk u -- unmounts RAM disk"
    fi
}


bind_transmission () {
    # sudo apt install transmission transmission-daemon
    # Kill transmission-daemon if it is running
    transmission_da_pids=$(pgrep transmission-da)
    if [ "$transmission_da_pids" ]; then
        echo "Killing transmission-daemon processes..."
        sudo pkill transmission-da
    fi

    # Get VPN IP to bind to
    # bind_address=$(ip -br addr show moz0 | awk '{print $3}')
    bind_address=$(curl http://ipecho.net/plain; echo)

    # If IP wasn't found then quit
    if [ -z $bind_address ]; then
        echo "VPN doesn't seem to be up. Will not start transmission-daemon"
        exit
    fi

    # Start transmission-daemon
    transmission-daemon --rpc-bind-address=127.0.0.1 --bind-address-ipv4=$bind_address

    echo "transmission-daemon started and bound to address $bind_address"
}
